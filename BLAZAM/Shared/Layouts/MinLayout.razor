@inherits LayoutComponentBase
@using BLAZAM.Server.Background;
@using BLAZAM.Server.Errors.ActiveDirectory;
@using BLAZAM.Server.Errors.Database;
@using Microsoft.Data.SqlClient;
@using System.DirectoryServices
@inject NavigationManager Nav
@inject ConnMonitor monitor


<PageTitle>Loading</PageTitle>
<Layout Sider>
    <LayoutSider>
        <LayoutSiderContent>
            <ErrorMenu />
        </LayoutSiderContent>
    </LayoutSider>
    <Layout>
        <LayoutHeader Fixed>
            @if (PageHeader != null)
            {
                @PageHeader
            }
        </LayoutHeader>
        <LayoutContent>
            <Card>
                <CardBody>
                    @Body

                </CardBody>
            </Card>
        </LayoutContent>

        <LayoutFooter>
            <AppFooter />

        </LayoutFooter>
    </Layout>
</Layout>

@code {
    [Parameter]
    public RenderFragment? PageHeader { get; set; }


    private void AppReady(ConnectionState newStatus)
    {
        if (newStatus == ConnectionState.Up)
        {
            if (Nav.ToBaseRelativePath(Nav.Uri) == "")
            {
                Nav.NavigateTo("/home");

            }
        }
    }

}


