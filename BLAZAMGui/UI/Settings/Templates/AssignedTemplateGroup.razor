@inherits AppComponentBase
<MudStack Row=true>

    <MudChip Color="Color.Primary"
             T="DirectoryTemplateGroup"
             Value="Group"
             Selected=false
             Text="@(ADGroup!=null?ADGroup.CanonicalName:("Unknown Group:"+ Group.GroupSid))"
             OnClose=@(Template.AssignedGroupSids?.Contains(Group)==true?(group)=>{
             Template.AssignedGroupSids.Remove(group.Value);
             OnGroupRemoved.InvokeAsync(Group);
             }:null) />
</MudStack>
@code {
    private DirectoryTemplateGroup _group;

    [Parameter]
    public DirectoryTemplateGroup Group
    {
        get => _group; set
        {
            if (_group == value) return;
            _group =value;
            LookupGroup();

        }
    }

    [CascadingParameter]
    public DirectoryTemplate Template { get; set; }

    [Parameter]
    public EventCallback<DirectoryTemplateGroup> OnGroupRemoved { get; set; }

    IADGroup? ADGroup;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        LookupGroup();
    }
    private void LookupGroup()
    {
        Task.Run(() =>
        {
            ADGroup = Directory.Groups.FindGroupBySID(Group.GroupSid);
            InvokeAsync(StateHasChanged);
        });
    }
}