@inherits AppComponentBase
<MudDataGrid Elevation=0
             Bordered=false
             Dense=true
             SortMode="SortMode.None"
             Items="Job.Steps">
    <ToolBarContent>
        <MudText Typo="Typo.h6">
            @{
                var title = Job.Name + " - ";
            }
            @switch (Job.Result)
            {
                case true:
                    title += AppLocalization["Success"];
                    break;
                case false:
                    title += AppLocalization["Failed"];
                    break;

                case null:
                    title += AppLocalization["Not Run"];
                    break;

            }
            @title
        </MudText>
        <MudSpacer />
    </ToolBarContent>
    <Columns>
        <TemplateColumn Title="Step">
            <CellTemplate>@context.Item.Name</CellTemplate>
        </TemplateColumn>
        <TemplateColumn Title="Result">
            <CellTemplate>
                @{
                    var color = Color.Success;
                    var icon = Icons.Material.Filled.Check;
                    var result = context.Item.Result;
                    switch (result)
                    {
                        case null:
                            color = Color.Warning;
                            icon = Icons.Material.Filled.QuestionMark;
                            break;
                        case false:
                            color = Color.Error;
                            icon = Icons.Material.Filled.Close;
                            break;
                    }
                }
                <MudIcon Color="@color"
                         Icon="@icon" />
            </CellTemplate>
        </TemplateColumn>
        <TemplateColumn Title="Message">
            <CellTemplate>
                <MudText>
                    @(context.Item.Result == true ? AppLocalization["Completed Successfully"] : context.Item.Exception?.Message)
                </MudText>
            </CellTemplate>
        </TemplateColumn>
        <HierarchyColumn ButtonDisabledFunc="@(x => x is not IJob)" />
    </Columns>
    <ChildRowContent>
        @if (context.Item is IJob)
        {
            <JobDetails Job="@((IJob)context.Item)"/>
        }
    </ChildRowContent>
</MudDataGrid>



@code {
    [Parameter]
    public IJob Job { get; set; }
}